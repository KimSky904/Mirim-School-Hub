//WINDOW 함수 -> 행과 행 관계를 정의하기 위함 (순위,합계 등 조작)
//첫행 ~ 마지막행 합계구하기
SELECT EMPNO,ENAME,SAL,SUM(SAL) OVER (ORDER BY SAL ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) TOTSAL FROM EMP;
//첫행 ~ 각 행별 누적합 구하기
SELECT EMPNO,ENAME,SAL,SUM(SAL) OVER (ORDER BY SAL ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) TOTSAL FROM EMP;
//현재행 ~ 마지막행 합계 구하기
SELECT EMPNO,ENAME,SAL,SUM(SAL) OVER (ORDER BY SAL ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) TOTSAL FROM EMP;
//순위함수
//RANK -> 동일순위 동일값
SELECT ENAME,SAL,RANK() OVER (ORDER BY SAL DESC) ALL RANK, RANK() OVER (PARTITION BY JOB ORDER BY SAL DESC) JOB_RANK FROM EMP;
//DENSE_RANK -> 동일순위 하나의 건수
SELECT ENAME,SAL,RANK() OVER (ORDER BY SAL DESC) ALL_RANK,DENSE_RANK() OVER (ORDER BY SAL DESC) DENSE_RANK FROM EMP;
//ROW_NUMBER -> 동일순위 고유순위부여
SELECT ENAME,SAL,RANK() OVER (ORDER BY SAL DESC) ALL_RANK, ROW_NUMBER() OVER (ORDER BY SAL DESC) ROW_NUM FROM EMP;
//집계함수 -> SUM,AVG,COUNT,MAX,MIN
//SUM
SELECT ENAME,SAL,MGR,SUM(SAL) OVER (PARTITION BY MGR) SUM_MGR FROM EMP;
//행 순서 관련 함수
//FIRST_VALUE -> MIN과 동일한 결과
SELECT DEPTNO,ENAME,SAL,FIRST_VALUE(ENAME) OVER (PARTITION BY DEPTNO ORDER BY SAL DESC ROWS UNBOUNDED PRECEDING) AS DEPT_A FROM EMP;
//LAST_VALUE -> MAX와 동일한 결과
SELECT DEPTNO,ENAME,SAL, LAST_VALUE(ENAME) OVER (PARTITION BY DEPTNO ORDER BY SAL DESC ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) AS DEPT_A FROM EMP;
//LAG -> 이전 행
SELECT DEPTNO,ENAME,SAL,LAG(SAL) OVER(ORDER BY SAL DESC) AS PRE_SAL FROM EMP;
//LEAD -> 특정위치 행(기본 1)
SELECT DEPTNO,ENAME,SAL,LEAD(SAL,2) OVER(ORDER BY SAL DESC) AS PRE_SAL FROM EMP;
//비율 관련 함수
//PERCENT_RANK() -> 등수의 퍼센트
SELECT DEPTNO,ENAME,SAL,PERCENT_RANK() OVER(PARTITION BY DEPTNO ORDER BY SAL DESC) AS PRECENT_SAL FROM EMP;
//NTILE(4) -> 4개로 분할
SELECT DEPTNO,ENAME,SAL,NTILE(4) OVER(ORDER BY SAL DESC) AS N_TILE FROM EMP;